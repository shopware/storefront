"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["plugin_offcanvas-cart_offcanvas-cart_plugin_js"],{6044:(t,e,i)=>{i.r(e),i.d(e,{default:()=>u});var n=i(9568),r=i(4049),s=i(3107),o=i(7),a=i(5206),c=i(6471),h=i(3266),g=i(9062),l=i(3327),d=i(9610);class u extends n.Z{init(){this.client=new s.Z,this._registerOpenTriggerEvents()}openOffCanvas(t,e,i){o.Z.open(t,e,this._onOffCanvasOpened.bind(this,i),this.options.offcanvasPosition,!0),o.Z.setAdditionalClassName(this.options.additionalOffcanvasClass)}_registerOpenTriggerEvents(){let t=a.Z.isTouchDevice()?"touchstart":"click";this.el.addEventListener(t,this._onOpenOffCanvasCart.bind(this))}_onOpenOffCanvasCart(t){t.preventDefault(),this.openOffCanvas(window.router["frontend.cart.offcanvas"],!1)}_registerRemoveProductTriggerEvents(){let t=r.Z.querySelectorAll(document,this.options.removeProductTriggerSelector,!1);t&&h.Z.iterate(t,t=>t.addEventListener("submit",this._onRemoveProductFromCart.bind(this)))}_registerChangeQuantityProductTriggerEvents(){let t=r.Z.querySelectorAll(document,this.options.changeProductQuantityTriggerSelector,!1),e=r.Z.querySelectorAll(document,this.options.changeProductQuantityTriggerNumberSelector,!1);t&&h.Z.iterate(t,t=>t.addEventListener("change",this._onChangeProductQuantity.bind(this))),e&&h.Z.iterate(e,t=>{t.addEventListener("change",d.Z.debounce(this._onChangeProductQuantity.bind(this),this.options.changeQuantityInputDelay))})}_registeraddPromotionTriggerEvents(){let t=r.Z.querySelectorAll(document,this.options.addPromotionTriggerSelector,!1);t&&h.Z.iterate(t,t=>t.addEventListener("submit",this._onAddPromotionToCart.bind(this)))}_registerUpdateShippingEvents(){let{shippingContainerSelector:t}=this.options,e=document.querySelector("".concat(t," select"));e&&e.addEventListener("input",this._onChangeShippingMethod.bind(this))}_registerToggleShippingSelection(){let{shippingToggleSelector:t,shippingContainerSelector:e}=this.options,i=document.querySelector(t);i&&i.addEventListener("click",()=>{let t=document.querySelector(e),i="offcanvas-shipping-preference--hidden";t.classList.contains(i)?t.classList.remove(i):t.classList.add(i)})}_registerEvents(){this._registerRemoveProductTriggerEvents(),this._registerChangeQuantityProductTriggerEvents(),this._registeraddPromotionTriggerEvents(),this._isShippingAvailable()&&(this._registerUpdateShippingEvents(),this._registerToggleShippingSelection()),this.$emitter.publish("registerEvents")}_onOffCanvasOpened(t,e){"function"==typeof t&&t(e),this.$emitter.publish("offCanvasOpened",{response:e}),this._fetchCartWidgets(),this._registerEvents()}_fireRequest(t,e,i){l.Z.create(t.closest(e));let n=i?i.bind(this):this._onOffCanvasOpened.bind(this,this._updateOffCanvasContent.bind(this)),s=r.Z.getAttribute(t,"action"),o=c.Z.serialize(t);this.$emitter.publish("beforeFireRequest"),this.client.post(s,o,n)}_onRemoveProductFromCart(t){t.preventDefault();let e=t.target,i=this.options.cartItemSelector;this.$emitter.publish("onRemoveProductFromCart"),this._fireRequest(e,i)}_onChangeProductQuantity(t){let e=t.target.closest("form"),i=this.options.cartItemSelector;this.$emitter.publish("onChangeProductQuantity"),this._fireRequest(e,i)}_onAddPromotionToCart(t){t.preventDefault();let e=t.target,i=this.options.cartPromotionSelector;this.$emitter.publish("onAddPromotionToCart"),this._fireRequest(e,i)}_fetchCartWidgets(){let t=window.PluginManager.getPluginInstances("CartWidget");h.Z.iterate(t,t=>t.fetch()),this.$emitter.publish("fetchCartWidgets")}_updateOffCanvasContent(t){g.Z.setContent(t,!0,this._registerEvents.bind(this)),window.PluginManager.initializePlugins()}_isShippingAvailable(){let{shippingContainerSelector:t}=this.options;return!!document.querySelector(t)}_onChangeShippingMethod(t){t.preventDefault(),this.$emitter.publish("onShippingMethodChange");let e=window.router["frontend.cart.offcanvas"];this._fireRequest(t.target.form,".offcanvas-summary",()=>{this.client.get(e,t=>{this._updateOffCanvasContent(t),this._registerEvents()},"text/html")})}}u.options={removeProductTriggerSelector:".js-offcanvas-cart-remove-product",changeProductQuantityTriggerSelector:".js-offcanvas-cart-change-quantity",changeProductQuantityTriggerNumberSelector:".js-offcanvas-cart-change-quantity-number",changeQuantityInputDelay:800,addPromotionTriggerSelector:".js-offcanvas-cart-add-promotion",cartItemSelector:".js-cart-item",cartPromotionSelector:".js-offcanvas-cart-promotion",offcanvasPosition:"right",shippingContainerSelector:".offcanvas-shipping-preference",shippingToggleSelector:".js-toggle-shipping-selection",additionalOffcanvasClass:"cart-offcanvas"}},6471:(t,e,i)=>{i.d(e,{Z:()=>r});var n=i(3266);class r{static serialize(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if("FORM"!==t.nodeName){if(e)throw Error("The passed element is not a form!");return{}}return new FormData(t)}static serializeJson(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=r.serialize(t,e);if(i==={})return i;let s={};return n.Z.iterate(i,(t,e)=>s[e]=t),s}}}}]);