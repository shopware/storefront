"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["plugin_zoom-modal_zoom-modal_plugin_js"],{2308:(t,e,i)=>{i.d(e,{FM:()=>n,P:()=>o});class s{get dimension(){return this.entries.length}validateDimensions(t){if(this.dimension!==t.dimension)throw Error("[Vector] dimension mismatch expected ".concat(this.dimension," got ").concat(t.dimension))}get x(){return this.entries[0]}set x(t){this.entries[0]=t}get y(){return this.entries[1]}set y(t){this.dimension>1&&(this.entries[1]=t)}get z(){return this.entries[2]}set z(t){this.dimension>2&&(this.entries[2]=t)}get w(){return this.entries[3]}set w(t){this.dimension>3&&(this.entries[3]=t)}length(){return Math.sqrt(this.entries.reduce((t,e)=>t+=e*e,0))}add(t){return this.validateDimensions(t),new this.constructor(this.entries.map((e,i)=>e+t.entries[i]))}multiply(t){if(t instanceof s)return this.validateDimensions(t),new this.constructor(this.entries.map((e,i)=>e*t.entries[i]));if("number"!=typeof t||Number.isNaN(t))throw Error("[Vector] multiply: factor must be number or vector");return new this.constructor(this.entries.map(e=>t*e))}subtract(t){return this.add(t.multiply(-1))}divide(t){if(t instanceof s)return new this.constructor(this.entries.map((e,i)=>e/t.entries[i]));if(0===t)throw Error("Can't divide by 0");return this.multiply(1/t)}normalize(){return new this.constructor(this.divide(this.length()))}equals(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];let n=e[0]instanceof s?e[0]:Array.isArray(e[0])?new s(e[0]):new s(e);try{return this.validateDimensions(n),this.entries.reduce((t,e,i)=>(e!==n.entries[i]&&(t=!1),t),!0)}catch(t){return!1}}dot(t){return this.validateDimensions(t),this.entries.reduce((e,i,s)=>e+=i*t.entries[s],0)}clamp(t,e){return"number"==typeof t&&(t=new this.constructor(Array(this.dimension).fill(t))),"number"==typeof e&&(e=new this.constructor(Array(this.dimension).fill(e))),new this.constructor(this.entries.map((i,s)=>i<t.entries[s]?t.entries[s]:i>e.entries[s]?e.entries[s]:i))}constructor(t){this.entries=t.map((t,e)=>{if("number"!=typeof t)throw Error("[Vector] argument ".concat(e," must be a number ").concat(typeof t," given."));return t})}}class n extends s{angle(){return(Math.atan2(this.y,this.x)*(180/Math.PI)+360)%360}constructor(t,e){if(t instanceof s){super(t.entries.slice(0,2));return}if(Array.isArray(t)){super(t.slice(0,2));return}super([t,e])}}class o extends s{cross(t){return new this.constructor(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)}constructor(t,e,i){if(t instanceof s){super(t.entries.slice(0,3));return}if(Array.isArray(t)){super(t.slice(0,3));return}super([t,e,i])}}},9043:(t,e,i)=>{i.r(e),i.d(e,{default:()=>d});var s=i(9568),n=i(5206),o=i(3266),r=i(4049),a=i(1272),l=i.n(a),h=i(2308);class m extends s.Z{init(){this._modal=this.el.closest(this.options.imageZoomModalSelector),this._image=r.Z.querySelector(this.el,this.options.imageSelector),this._zoomInActionElement=r.Z.querySelector(this._modal,this.options.zoomInActionSelector),this._zoomResetActionElement=r.Z.querySelector(this._modal,this.options.zoomResetActionSelector),this._zoomOutActionElement=r.Z.querySelector(this._modal,this.options.zoomOutActionSelector),this._imageMaxSize=new h.FM(this._image.naturalWidth,this._image.naturalHeight).multiply(2),this._imageSize=new h.FM(this._image.offsetWidth,this._image.offsetHeight),this._containerSize=new h.FM(this.el.offsetWidth,this.el.offsetHeight),this._storedTransform=new h.P(0,0,1),this._transform=new h.P(this._storedTransform.x,this._storedTransform.y,this._storedTransform.z),this._translateRange=new h.FM(0,0),this._updateTranslateRange(),this._initHammer(),this._registerEvents(),this._setActionButtonState()}update(){this._updateTransform(),this._setActionButtonState()}_initHammer(){this._hammer=new(l())(this.el),this._hammer.get("pinch").set({enable:!0}),this._hammer.get("pan").set({direction:l().DIRECTION_ALL})}_registerEvents(){this._hammer.on("pan",t=>this._onPan(t)),this._hammer.on("pinch pinchmove",t=>this._onPinch(t)),this._hammer.on("doubletap",t=>this._onDoubleTap(t)),this._hammer.on("panend pancancel pinchend pinchcancel",t=>this._onInteractionEnd(t)),this.el.addEventListener("wheel",t=>this._onMouseWheel(t),!1),this._image.addEventListener("mousedown",t=>t.preventDefault(),!1),window.addEventListener("resize",t=>this._onResize(t),!1),this._zoomInActionElement.addEventListener("click",t=>this._onZoomIn(t),!1),this._zoomResetActionElement.addEventListener("click",t=>this._onResetZoom(t),!1),this._zoomOutActionElement.addEventListener("click",t=>this._onZoomOut(t),!1)}_isActive(){return!1===this.options.activeClassSelector||null!==this.el.closest(this.options.activeClassSelector)}_onPan(t){this._isActive()&&(this._transform=this._storedTransform.add(new h.P(t.deltaX,t.deltaY,0)),this._unsetTransition(),this._updateTransform(),this._setCursor("move")),this.$emitter.publish("onPan")}_onPinch(t){if(this._isActive()){let e=this._storedTransform.x+t.deltaX,i=this._storedTransform.x+t.deltaY,s=this._storedTransform.z*t.scale;this._transform=new h.P(e,i,s),this._unsetTransition(),this._updateTransform(),this._setCursor("move")}this.$emitter.publish("onPinch")}_onDoubleTap(){if(this._isActive()){let t=this._getMaxZoomValue(),e=this._storedTransform.z>=t?1:t;this._transform=new h.P(this._transform.x,this._transform.y,e),this._setTransition(),this._updateTransform(!0)}this.$emitter.publish("onDoubleTap")}_onZoomIn(){if(this._isActive()){let t=this._getMaxZoomValue()/this.options.zoomSteps;this._transform=this._transform.add(new h.P(0,0,t)),this._setTransition(),this._updateTransform(!0)}this.$emitter.publish("onZoomIn")}_onResetZoom(){this._isActive()&&(this._transform=new h.P(this._transform.x,this._transform.y,1),this._setTransition(),this._updateTransform(!0)),this.$emitter.publish("onResetZoom")}_onZoomOut(){if(this._isActive()){let t=this._getMaxZoomValue()/this.options.zoomSteps;this._transform=this._transform.subtract(new h.P(0,0,t)),this._setTransition(),this._updateTransform(!0)}this.$emitter.publish("onZoomOut")}_onMouseWheel(t){this._isActive()&&(this._transform=this._transform.add(new h.P(0,0,t.wheelDelta/800)),this._unsetTransition(),this._updateTransform(!0)),this.$emitter.publish("onMouseWheel")}_onInteractionEnd(){this._isActive()&&(this._updateTransform(!0),this._setCursor("default")),this.$emitter.publish("onInteractionEnd")}_onResize(){this._getElementSizes(),this._updateTransform(!0),this.$emitter.publish("onResize")}_getElementSizes(){this._imageSize=new h.FM(this._image.offsetWidth,this._image.offsetHeight),this._containerSize=new h.FM(this.el.offsetWidth,this.el.offsetHeight),this.$emitter.publish("getElementSizes")}_updateTransform(t){this._updateTranslateRange(),this._clampTransform(),this._setActionButtonState();let e="translateX(".concat(Math.round(this._transform.x),"px)"),i="translateY(".concat(Math.round(this._transform.y),"px)"),s="scale(".concat(this._transform.z,",").concat(this._transform.z,")"),n="".concat(e," ").concat(i," translateZ(0px) ").concat(s);this._image.style.transform=n,this._image.style.WebkitTransform=n,this._image.style.msTransform=n,t&&this._updateStoredTransformVector(),this.$emitter.publish("updateTransform")}_setActionButtonState(){1===this._transform.z&&1===this._getMaxZoomValue()?(this._setButtonDisabledState(this._zoomResetActionElement),this._setButtonDisabledState(this._zoomOutActionElement),this._setButtonDisabledState(this._zoomInActionElement)):this._getMaxZoomValue()===this._transform.z&&this._isTranslatable()?(this._setButtonDisabledState(this._zoomResetActionElement),this._setButtonDisabledState(this._zoomOutActionElement),this._setButtonDisabledState(this._zoomInActionElement)):this._getMaxZoomValue()===this._transform.z?(this._unsetButtonDisabledState(this._zoomResetActionElement),this._unsetButtonDisabledState(this._zoomOutActionElement),this._setButtonDisabledState(this._zoomInActionElement)):(1===this._transform.z?(this._setButtonDisabledState(this._zoomResetActionElement),this._setButtonDisabledState(this._zoomOutActionElement)):(this._unsetButtonDisabledState(this._zoomResetActionElement),this._unsetButtonDisabledState(this._zoomOutActionElement)),this._unsetButtonDisabledState(this._zoomInActionElement)),this.$emitter.publish("setActionButtonState")}_isTranslatable(){return 0===this._translateRange.x&&0===this._translateRange.y}_setButtonDisabledState(t){t.classList.add("disabled"),t.disabled=!0,this.$emitter.publish("setButtonDisabledState")}_unsetButtonDisabledState(t){t.classList.remove("disabled"),t.disabled=!1,this.$emitter.publish("unsetButtonDisabledState")}_updateStoredTransformVector(){this._clampTransform(),this._storedTransform=new h.P(this._transform.x,this._transform.y,this._transform.z)}_updateTranslateRange(){this._getElementSizes();let t=this._imageSize.multiply(this._transform.z);t.x=Math.round(t.x),t.y=Math.round(t.y),this._translateRange=t.subtract(this._containerSize).clamp(0,t).divide(2)}_getMaxZoomValue(){if(this._getElementSizes(),0===this._imageSize.x||0===this._imageSize.y)return 1;let t=this._imageMaxSize.divide(this._imageSize);return Math.max(t.x,t.y)}_setCursor(t){this.el.style.cursor=t,this.$emitter.publish("setCursor")}_setTransition(){let t="all 350ms ease 0s";this._image.style.transition=t,this._image.style.WebkitTransition=t,this._image.style.msTransition=t,this.$emitter.publish("setTransition")}_unsetTransition(){this._image.style.transition="",this._image.style.WebkitTransition="",this._image.style.msTransition="",this.$emitter.publish("unsetTransition")}_clampTransform(){let t=new h.P(-this._translateRange.x,-this._translateRange.y,1),e=new h.P(this._translateRange.x,this._translateRange.y,this._getMaxZoomValue());this._transform=this._transform.clamp(t,e)}}m.options={maxZoom:"auto",zoomSteps:5,imageZoomModalSelector:"[data-image-zoom-modal=true]",imageSelector:".js-image-zoom-element",zoomInActionSelector:".js-image-zoom-in",zoomResetActionSelector:".js-image-zoom-reset",zoomOutActionSelector:".js-image-zoom-out",activeClassSelector:".tns-slide-active",gallerySliderSelector:"[data-modal-gallery-slider]"};class d extends s.Z{init(){this._triggers=this.el.querySelectorAll(this.options.triggerSelector),this._triggersCanvas=this.el.querySelectorAll(this.options.triggerSelectorCanvas),this._clickInterrupted=!1,this._pixelsMoved=0,this._mouseDown=!1,this._registerEvents()}_registerEvents(){let t=n.Z.isTouchDevice()?"touchend":"click";o.Z.iterate(this._triggers,e=>{e.removeEventListener(t,this._onClick.bind(this)),e.addEventListener(t,this._onClick.bind(this))}),o.Z.iterate(this._triggers,t=>{t.removeEventListener("touchmove",this._onTouchMove.bind(this)),t.addEventListener("touchmove",this._onTouchMove.bind(this))}),o.Z.iterate(this._triggersCanvas,t=>{t.removeEventListener("mousedown",this._onMouseDown.bind(this)),t.addEventListener("mousedown",this._onMouseDown.bind(this))}),o.Z.iterate(this._triggersCanvas,t=>{t.removeEventListener("mouseup",this._onMouseUp.bind(this)),t.addEventListener("mouseup",this._onMouseUp.bind(this))}),o.Z.iterate(this._triggersCanvas,e=>{e.removeEventListener(t,this._onClick.bind(this)),e.addEventListener(t,this._onClick.bind(this))}),o.Z.iterate(this._triggersCanvas,t=>{t.removeEventListener("pointermove",this._onPointerMove.bind(this)),t.addEventListener("pointermove",this._onPointerMove.bind(this))})}_onClick(t){if(!0===this._clickInterrupted||this._pixelsMoved>10){this._clickInterrupted=!1,this._pixelsMoved=0;return}this._pixelsMoved=0,d._stopEvent(t),this._openModal(),this.$emitter.publish("onClick")}_onTouchMove(){this._clickInterrupted=!0}_onPointerMove(t){"mouse"==t.pointerType?this._mouseDown&&(this._pixelsMoved+=2):this._pixelsMoved+=1}_onMouseDown(){this._mouseDown=!0,this._clickInterrupted=!1}_onMouseUp(){this._mouseDown=!1}_openModal(){let t=this.el.closest(this.options.galleryZoomModalContainerSelector).querySelector(this.options.modalSelector);t&&this._loadImages(t),this.$emitter.publish("onClick",{modal:t})}_loadImages(t){let e=t.querySelectorAll("img["+this.options.imgDataSrcAttr+"]"+this.options.imgToLoadSelector),i=e.length;if(0===i){this._showModal(t);return}let s=0,n=0;o.Z.iterate(e,e=>{let o=r.Z.getDataAttribute(e,this.options.imgDataSrcAttr),a=r.Z.getDataAttribute(e,this.options.imgDataSrcSetAttr,!1);o&&(e.onload=()=>{++s+n===i&&this._showModal(t)},e.onerror=()=>{n++,s+n===i&&this._showModal(t)},e.setAttribute("src",o),e.removeAttribute(this.options.imgDataSrcAttr),a&&(e.setAttribute("srcset",a),e.removeAttribute(this.options.imgDataSrcSetAttr)))})}_showModal(t){let e=new bootstrap.Modal(t,{keyboard:!1});this._showModalListener||(this._showModalListener=()=>{this._initSlider(t),this._registerImageZoom(),this.$emitter.publish("modalShow",{modal:t})}),t.removeEventListener("shown.bs.modal",this._showModalListener),t.addEventListener("shown.bs.modal",this._showModalListener),e.show()}_initSlider(t){let e=t.querySelector(this.options.modalGallerySliderSelector);if(!e)return;let i=this._getParentSliderIndex();if(this.gallerySliderPlugin&&this.gallerySliderPlugin._slider){this.gallerySliderPlugin._slider.goTo(i-1);return}window.PluginManager.initializePlugin("GallerySlider",e,{slider:{startIndex:i,touch:!1},thumbnailSlider:{startIndex:i,autoWidth:!0,responsive:{md:{enabled:!0},lg:{enabled:!0},xl:{enabled:!0,axis:"horizontal"}}}}),this.gallerySliderPlugin=window.PluginManager.getPluginInstanceFromElement(e,"GallerySlider"),this.$emitter.publish("initSlider")}_registerImageZoom(){this.imageZoomRegistered||(this.gallerySliderPlugin?(window.PluginManager.register("ImageZoom",m,this.options.activeSlideSelector+" "+this.options.imageZoomInitSelector),window.PluginManager.initializePlugin("ImageZoom",this.options.activeSlideSelector+" "+this.options.imageZoomInitSelector),this.gallerySliderPlugin._slider.events.off("indexChanged",this._updateImageZoom.bind(this)),this.gallerySliderPlugin._slider.events.on("indexChanged",this._updateImageZoom.bind(this))):(window.PluginManager.register("ImageZoom",m,this.options.imageZoomInitSelector),window.PluginManager.initializePlugin("ImageZoom",this.options.imageZoomInitSelector,{activeClassSelector:!1})),this.imageZoomRegistered=!0)}_updateImageZoom(){let t=this.gallerySliderPlugin.getActiveSlideElement();if(!t)return;let e=t.querySelector(this.options.imageZoomInitSelector);if(!e)return;let i=window.PluginManager.getPluginInstanceFromElement(e,"ImageZoom");i?i.update():window.PluginManager.initializePlugin("ImageZoom",this.options.activeSlideSelector+" "+this.options.imageZoomInitSelector)}_getParentSliderIndex(){let t=1;return this._parentSliderElement=this.el.closest(this.options.parentGallerySliderSelector),this._parentSliderElement&&(this._parentSliderPlugin=window.PluginManager.getPluginInstanceFromElement(this._parentSliderElement,"GallerySlider"),this._parentSliderPlugin&&(t=this._parentSliderPlugin.getCurrentSliderIndex())),t+1}static _stopEvent(t){t&&(t.stopPropagation(),t.preventDefault())}}d.options={modalSelector:".js-zoom-modal",triggerSelector:"img",triggerSelectorCanvas:"canvas",productIdDataAttribute:"data-product-id",modalGallerySliderSelector:"[data-modal-gallery-slider]",parentGallerySliderSelector:"[data-gallery-slider]",imageZoomInitSelector:"[data-image-zoom]",galleryZoomModalContainerSelector:".js-gallery-zoom-modal-container",imgToLoadSelector:".js-load-img",imgDataSrcAttr:"data-src",imgDataSrcSetAttr:"data-srcset",activeSlideSelector:".tns-slide-active"}}}]);